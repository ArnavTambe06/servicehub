{"ast":null,"code":"var _jsxFileName = \"C:\\\\Project\\\\we-care\\\\src\\\\pages\\\\SignUp.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useContext } from 'react';\nimport { useHistory, Link } from 'react-router-dom';\nimport { AuthContext } from '../contexts/AuthContext';\nimport { GoogleAuthProvider, signInWithPopup, signInWithPhoneNumber, RecaptchaVerifier } from 'firebase/auth';\nimport { doc, setDoc } from 'firebase/firestore';\nimport { auth, db } from '../firebaseInit';\nimport PhoneInput from 'react-phone-input-2';\nimport 'react-phone-input-2/lib/style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SignUp = () => {\n  _s();\n  const history = useHistory();\n  const {\n    setIsProvider\n  } = useContext(AuthContext);\n  const [loading, setLoading] = useState(false);\n  const [phoneNumber, setPhoneNumber] = useState('');\n  const [otp, setOtp] = useState('');\n  const [verificationId, setVerificationId] = useState(null);\n\n  // Google Sign-In\n  const handleGoogleSignIn = async () => {\n    const provider = new GoogleAuthProvider();\n    try {\n      const result = await signInWithPopup(auth, provider);\n      const user = result.user;\n\n      // Save user details in Firestore\n      await setDoc(doc(db, 'users', user.uid), {\n        userFirstName: user.displayName.split(' ')[0] || '',\n        userLastName: user.displayName.split(' ')[1] || '',\n        userEmail: user.email,\n        userPhoneNumber: user.phoneNumber || 'Not Provided',\n        role: 0 // Regular user\n      });\n      alert('Google sign-in successful!');\n      history.push('/');\n    } catch (error) {\n      console.error('Google Sign-In Error:', error);\n      alert(error.message);\n    }\n  };\n\n  // Initialize Recaptcha for phone authentication\n  const setUpRecaptcha = () => {\n    window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', {\n      size: 'invisible',\n      callback: response => {\n        console.log('Recaptcha verified!');\n      },\n      'expired-callback': () => {\n        alert('Recaptcha expired, please try again.');\n      }\n    });\n  };\n\n  // Send OTP\n  const sendOtp = async () => {\n    setLoading(true);\n    setUpRecaptcha();\n    try {\n      const confirmation = await signInWithPhoneNumber(auth, `+${phoneNumber}`, window.recaptchaVerifier);\n      setVerificationId(confirmation.verificationId);\n      alert('OTP sent successfully!');\n    } catch (error) {\n      alert('Failed to send OTP: ' + error.message);\n    }\n    setLoading(false);\n  };\n\n  // Verify OTP\n  const verifyOtp = async () => {\n    setLoading(true);\n    try {\n      const credential = auth.PhoneAuthProvider.credential(verificationId, otp);\n      const userCredential = await auth.signInWithCredential(credential);\n      const user = userCredential.user;\n\n      // Save user details in Firestore\n      await setDoc(doc(db, 'users', user.uid), {\n        userPhoneNumber: user.phoneNumber,\n        role: 0 // Regular user\n      });\n      alert('Phone authentication successful!');\n      history.push('/');\n    } catch (error) {\n      alert('Failed to verify OTP: ' + error.message);\n    }\n    setLoading(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"signup-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Sign Up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleGoogleSignIn,\n      children: \"Sign in with Google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Sign up with Phone\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(PhoneInput, {\n        country: 'us',\n        value: phoneNumber,\n        onChange: setPhoneNumber\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendOtp,\n        disabled: loading,\n        children: \"Send OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"recaptcha-container\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter OTP\",\n        value: otp,\n        onChange: e => setOtp(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: verifyOtp,\n        disabled: loading,\n        children: \"Verify OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 9\n  }, this);\n};\n_s(SignUp, \"YjeC+wWpdN6Yvmv+nQ7chXcbSPM=\", false, function () {\n  return [useHistory];\n});\n_c = SignUp;\nexport default SignUp;\nvar _c;\n$RefreshReg$(_c, \"SignUp\");","map":{"version":3,"names":["React","useState","useContext","useHistory","Link","AuthContext","GoogleAuthProvider","signInWithPopup","signInWithPhoneNumber","RecaptchaVerifier","doc","setDoc","auth","db","PhoneInput","jsxDEV","_jsxDEV","SignUp","_s","history","setIsProvider","loading","setLoading","phoneNumber","setPhoneNumber","otp","setOtp","verificationId","setVerificationId","handleGoogleSignIn","provider","result","user","uid","userFirstName","displayName","split","userLastName","userEmail","email","userPhoneNumber","role","alert","push","error","console","message","setUpRecaptcha","window","recaptchaVerifier","size","callback","response","log","expired-callback","sendOtp","confirmation","verifyOtp","credential","PhoneAuthProvider","userCredential","signInWithCredential","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","country","value","onChange","disabled","id","type","placeholder","e","target","_c","$RefreshReg$"],"sources":["C:/Project/we-care/src/pages/SignUp.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { useHistory, Link } from 'react-router-dom';\r\nimport { AuthContext } from '../contexts/AuthContext';\r\nimport { GoogleAuthProvider, signInWithPopup, signInWithPhoneNumber, RecaptchaVerifier } from 'firebase/auth';\r\nimport { doc, setDoc } from 'firebase/firestore';\r\nimport { auth, db } from '../firebaseInit';\r\nimport PhoneInput from 'react-phone-input-2';\r\nimport 'react-phone-input-2/lib/style.css';\r\n\r\nconst SignUp = () => {\r\n    const history = useHistory();\r\n    const { setIsProvider } = useContext(AuthContext);\r\n    const [loading, setLoading] = useState(false);\r\n    const [phoneNumber, setPhoneNumber] = useState('');\r\n    const [otp, setOtp] = useState('');\r\n    const [verificationId, setVerificationId] = useState(null);\r\n\r\n    // Google Sign-In\r\n    const handleGoogleSignIn = async () => {\r\n        const provider = new GoogleAuthProvider();\r\n        try {\r\n            const result = await signInWithPopup(auth, provider);\r\n            const user = result.user;\r\n\r\n            // Save user details in Firestore\r\n            await setDoc(doc(db, 'users', user.uid), {\r\n                userFirstName: user.displayName.split(' ')[0] || '',\r\n                userLastName: user.displayName.split(' ')[1] || '',\r\n                userEmail: user.email,\r\n                userPhoneNumber: user.phoneNumber || 'Not Provided',\r\n                role: 0, // Regular user\r\n            });\r\n\r\n            alert('Google sign-in successful!');\r\n            history.push('/');\r\n        } catch (error) {\r\n            console.error('Google Sign-In Error:', error);\r\n            alert(error.message);\r\n        }\r\n    };\r\n\r\n    // Initialize Recaptcha for phone authentication\r\n    const setUpRecaptcha = () => {\r\n        window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', {\r\n            size: 'invisible',\r\n            callback: (response) => {\r\n                console.log('Recaptcha verified!');\r\n            },\r\n            'expired-callback': () => {\r\n                alert('Recaptcha expired, please try again.');\r\n            }\r\n        });\r\n    };\r\n\r\n    // Send OTP\r\n    const sendOtp = async () => {\r\n        setLoading(true);\r\n        setUpRecaptcha();\r\n        try {\r\n            const confirmation = await signInWithPhoneNumber(auth, `+${phoneNumber}`, window.recaptchaVerifier);\r\n            setVerificationId(confirmation.verificationId);\r\n            alert('OTP sent successfully!');\r\n        } catch (error) {\r\n            alert('Failed to send OTP: ' + error.message);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    // Verify OTP\r\n    const verifyOtp = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const credential = auth.PhoneAuthProvider.credential(verificationId, otp);\r\n            const userCredential = await auth.signInWithCredential(credential);\r\n            const user = userCredential.user;\r\n\r\n            // Save user details in Firestore\r\n            await setDoc(doc(db, 'users', user.uid), {\r\n                userPhoneNumber: user.phoneNumber,\r\n                role: 0, // Regular user\r\n            });\r\n\r\n            alert('Phone authentication successful!');\r\n            history.push('/');\r\n        } catch (error) {\r\n            alert('Failed to verify OTP: ' + error.message);\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"signup-container\">\r\n            <h2>Sign Up</h2>\r\n            {/* Google Sign-In */}\r\n            <button onClick={handleGoogleSignIn}>Sign in with Google</button>\r\n\r\n            {/* Phone Authentication */}\r\n            <div>\r\n                <h3>Sign up with Phone</h3>\r\n                <PhoneInput\r\n                    country={'us'}\r\n                    value={phoneNumber}\r\n                    onChange={setPhoneNumber}\r\n                />\r\n                <button onClick={sendOtp} disabled={loading}>Send OTP</button>\r\n\r\n                <div id=\"recaptcha-container\"></div>\r\n\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Enter OTP\"\r\n                    value={otp}\r\n                    onChange={(e) => setOtp(e.target.value)}\r\n                />\r\n                <button onClick={verifyOtp} disabled={loading}>Verify OTP</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SignUp;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}